function send_msg(token, msg, channel_id) {
  req = new XMLHttpRequest();
  req.open("POST", `https://discord.com/api/v9/channels/${channel_id}/messages`);
  payload = {'content': msg};
  req.setRequestHeader("authorization", token);
  req.setRequestHeader("content-type", "application/json")
  req.onload = function() {console.log(this.responseText);};
  req.send(JSON.stringify(payload));
}
function main () {
  loginToken = document.createElement('button')
  loginToken.style.left = '10px'
  loginToken.style.top = '10px'
  loginToken.innerHTML = 'login token'
  loginToken.style.position = 'fixed'
  loginToken.style.font = 'inherit'
  loginToken.style.width = '50px'
  loginToken.style.height = '50px'
  loginToken.id = 'login_token'
  loginToken.onclick = function () {
    token = prompt('token')
    req = new XMLHttpRequest()
    req.open('GET',
      'https://discord.com/api/v9/users/@me')
    req.setRequestHeader('authorization',
      token)
    req.responseType = 'json'
    req.onload = function () {
      if (this.response.code !== 0) {
        if (this.response.id !== '') {
          window.alert(JSON.stringify(this.response))
          lT = document.getElementById('login_token')
          lT.remove()
          lEP = document.getElementById('login_email_pass')
          lEP.remove()
          guilds = new XMLHttpRequest()
          guilds.open('GET','https://discord.com/api/v9/users/@me/guilds')
          guilds.setRequestHeader('authorization',token)
          guilds.responseType = 'json'
          guilds.onload = function () {
            guilds = this.response
            guildsDiv = document.createElement('div')
            guildsDiv.style.height = `${window.innerHeight}px`
            guildsDiv.style.width = '50px'
            guildsDiv.style.left = '10px'
            guildsDiv.id = 'guilds_div'
            for (const guild in guilds) {
              console.log(guilds[guild])
              img = document.createElement('img')
              img.src = `https://cdn.discordapp.com/icons/${guilds[guild].id}/${guilds[guild].icon}.webp?size=64`
              img.style.width = '50px'
              img.style.height = '50px'
              img.id = guilds[guild].name
              img.style.borderRadius = '50%'
              img.style.background = '#000000'
              document.body.append(guildsDiv)
              guildsDiv.appendChild(img)
            }
          }
 		  guilds.send()
        }
      }
    }
    req.send()
  }
  loginEmailPass = document.createElement('button')
  loginEmailPass.style.left = '60px'
  loginEmailPass.style.top = '10px'
  loginEmailPass.innerHTML = 'login email and pass'
  loginEmailPass.style.position = 'fixed'
  loginEmailPass.style.font = 'inherit'
  loginEmailPass.style.width = '70px'
  loginEmailPass.style.height = '100px'
  loginEmailPass.id = 'login_email_pass'
  loginEmailPass.onclick = function loginPassEmails () {
    email = prompt('email')
    pass = prompt('password')
    req = new XMLHttpRequest()
    req.open('POST','https://discord.com/api/v9/auth/login')
    data = {captcha_key: null, gift_code_sku_id: null, login: email, login_source: null, password: pass, undelete: false}
    req.responseType = 'json'
    req.setRequestHeader('origin','https://discord.com')
    req.setRequestHeader('referer','https://discord.com/login')
    req.setRequestHeader('sec-fetch-site','same-origin')
    req.setRequestHeader('content-type','application/json')
    req.onload = function () {
      if (this.response.user_id !== '') {
        if (this.response.message !== 'Invalid Form Body') {
          window.alert(JSON.stringify(this.response))
          lT = document.getElementById('login_token')
          lT.remove()
          lEP = document.getElementById('login_email_pass')
          lEP.remove()
        }
      }
    }
    req.send(JSON.stringify(data))
  }
  document.body.appendChild(loginToken)
  document.body.appendChild(loginEmailPass)
}
